sudo: required

services:
  - docker

## Make sure all containers build without error.
before_install: 
  - docker build -t soulmachine/r-base r-base
  - docker build -t soulmachine/rstudio rstudio

## A few simple / crude tests
script:
  - docker run -ti soulmachine/r-base R --version
  - docker run -d --name rstudio soulmachine/rstudio
  - sleep 5 && docker ps | grep rstudio
  - docker rm -f $(docker ps -a -q)

after_success:
  - docker login -e="$DOCKER_EMAIL" -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"
  - docker push $DOCKER_USERNAME/r-base
  - docker push $DOCKER_USERNAME/rstudio
